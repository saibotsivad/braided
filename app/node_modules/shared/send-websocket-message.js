const AWS = require("aws-sdk")

const sendMessage = async event => {
	try {
		const domain = `${event.requestContext.apiId}.execute-api.us-east-1.amazonaws.com`
		const api = new AWS.ApiGatewayManagementApi({
			apiVersion: "2018-11-29",
			endpoint: `https://${domain}/${event.requestContext.stage}`
		})
		const result = await api.postToConnection({
			ConnectionId: event.requestContext.connectionId,
			Data: JSON.stringify({ received: JSON.parse(event.body) })
		}).promise()
		console.log(JSON.stringify(result))
	} catch (error) {
		console.error(error)
	}
}
