import { dynamodb } from 'shared/dynamodb.js'
import { handleRequest } from './handle-request.js'

const credentials = {}
const accounts = {}

const service = {
	dynamodb: credentials => dynamodb(credentials),
	getCredentials: async key => {
		if (!credentials[key]) {
			credentials[key] = JSON.parse(await CREDENTIALS.get(key))
		}
		return credentials[key]
	},
	getAccount: async accountId => {
		if (!accounts[accountId]) {
			accounts[accountId] = JSON.parse(await ACCOUNTS.get(accountId))
		}
		return accounts[accountId]
	}
}

export { service }
