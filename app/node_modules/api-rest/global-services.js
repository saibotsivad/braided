import { dynamodb } from 'shared/dynamodb.js'
import { handleRequest } from './handle-request.js'

const accounts = {}
const configurations = {}

const service = {
	dynamodb: configuration => dynamodb(configuration),
	getConfiguration: async key => {
		if (!configurations[key]) {
			configurations[key] = JSON.parse(await CONFIGS.get(key))
		}
		return configurations[key]
	},
	getAccount: async accountId => {
		if (!accounts[accountId]) {
			accounts[accountId] = JSON.parse(await ACCOUNTS.get(accountId))
		}
		return accounts[accountId]
	}
}

export { service }
