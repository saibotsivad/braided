export const tokenPackager = ({ base64encode, secret, sign }) => {
	const encode = obj => base64encode(JSON.stringify(obj))

	return async ({ userId, expirationUnixTime }) => {
		const header = encode({
			alg: 'HS256',
			typ: 'JWT'
		})
		const payload = encode({
			exp: expirationUnixTime,
			sub: userId,
			iss: 'braidedjs'
		})
		const signature = await sign({
			string: `${header}.${payload}`,
			secret
		})
		return [ header, payload, signature ].join('.')
	}
}
