import ApiGatewayManagementApi from 'aws-sdk/clients/apigatewaymanagementapi'

export const sendWebsocketMessage = async ({ apiId, stage, connectionId }, data) => {
	try {
		const domain = `${apiId}.execute-api.us-east-1.amazonaws.com`
		const api = new ApiGatewayManagementApi({
			apiVersion: "2018-11-29",
			endpoint: `https://${domain}/${stage}`
		})
		await api.postToConnection({
			ConnectionId: connectionId,
			Data: JSON.stringify(data)
		}).promise()
	} catch (error) {
		console.error('error during ApiGatewayManagementApi.postToConnection', error)
	}
}
