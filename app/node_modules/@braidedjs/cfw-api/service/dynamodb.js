import { getConfiguration } from './get-configuration.js'
import { dynamodb as initialize } from 'shared/dynamodb.js'

const namedDynamodb = {}

export const dynamodb = async (name = 'primary') => {
	if (!namedDynamodb[name]) {
		const { credentials, TableName } = await getConfiguration(`dynamodb:${name}`)
		namedDynamodb[name] = {
			db: initialize(credentials),
			TableName
		}
	}
	return namedDynamodb[name]
}
